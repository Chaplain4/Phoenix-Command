import re

from phoenix_command.models.enums import AdvancedHitLocation
from phoenix_command.models.hit_result_advanced import DamageResult


class AdvancedDamageCalculator:
    # Damage tables database
    TABLES_DATA = {
        1: {
            "epen": [0.1, 0.2, 0.3, 0.4, 0.6, 0.7, 0.8, 0.9, 1.0, 1.1, 1.2, 1.3],
            "shock": {0.6: "10", 0.9: "20"},  # Shock values added
            "organs": [
                (0.1, 0.2, "Scalp", False),
                (0.2, 1.2, "Skull Bone", False),
                (1.2, 1.3, "Scalp", False)
            ],
            "dc": {
                10: ["164", "423", "783", "12H", "18H", "24H", "31H", "39H", "48H", "58H", "76H", "84H"],
                9: ["76", "197", "364", "576", "830", "11H", "15H", "18H", "22H", "27H", "36H", "39H"],
                8: ["35", "90", "166", "263", "379", "514", "666", "835", "10H", "12H", "16H", "18H"],
                7: ["20", "51", "94", "148", "214", "289", "375", "471", "576", "690", "914", "10H"],
                6: ["8", "22", "40", "64", "92", "124", "161", "202", "247", "296", "392", "433"],
                5: ["6", "15", "27", "43", "61", "83", "108", "135", "165", "198", "263", "289"],
                4: ["3", "9", "16", "25", "37", "50", "64", "81", "99", "118", "156", "172"],
                3: ["2", "4", "8", "12", "18", "24", "31", "39", "47", "57", "75", "83"],
                2: ["1", "1", "2", "4", "5", "7", "9", "11", "14", "16", "22", "24"],
                1: ["1", "1", "1", "1", "1", "2", "3", "3", "4", "5", "6", "7"]
            }
        },
        2: {
            "epen": [0.4, 0.7, 0.8, 0.9, 1.0, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.8, 3.2],
            "shock": {0.4: "10", 0.7: "20", 3.2: "40"},
            "organs": [
                (0.4, 0.7, "Skull", False),
                (0.8, 2.5, "Brain", False),
                (2.8, 3.2, "Skull", False)
            ],
            "dc": {
                10: ["22", "29K", "20T", "72T", "74T", "79T", "83T", "88T", "93T", "98T", "10X", "11X", "11X", "12X", "12X", "13X", "13X", "14X", "14X", "15X", "15X", "15X"],
                9: ["15", "19K", "13T", "47T", "49T", "52T", "55T", "58T", "62T", "65T", "66T", "70T", "73T", "77T", "81T", "84T", "86T", "90T", "94T", "96T", "96T", "97T"],
                8: ["9", "11K", "79K", "28T", "29T", "31T", "32T", "34T", "36T", "38T", "39T", "41T", "43T", "45T", "48T", "50T", "51T", "53T", "56T", "57T", "57T", "57T"],
                7: ["5", "65H", "46K", "16T", "17T", "18T", "19T", "20T", "21T", "22T", "23T", "24T", "25T", "26T", "28T", "29T", "29T", "31T", "32T", "33T", "33T", "33T"],
                6: ["2", "28H", "20K", "69K", "71K", "76K", "80K", "85K", "90K", "95K", "97K", "10T", "11T", "11T", "12T", "12T", "13T", "13T", "14T", "14T", "14T", "14T"],
                5: ["1", "19H", "13K", "46K", "48K", "51K", "54K", "57K", "60K", "63K", "65K", "68K", "71K", "75K", "79K", "82K", "84K", "88K", "92K", "94K", "95K", "95K"],
                4: ["1", "11H", "78H", "28K", "28K", "30K", "32K", "34K", "36K", "38K", "39K", "41K", "43K", "45K", "47K", "49K", "50K", "53K", "55K", "56K", "56K", "56K"],
                3: ["1", "539", "38H", "13K", "14K", "15K", "15K", "16K", "17K", "18K", "19K", "20K", "21K", "22K", "23K", "24K", "24K", "25K", "27K", "27K", "27K", "27K"],
                2: ["1", "155", "11H", "38H", "39H", "42H", "44H", "50H", "52H", "53H", "56H", "62H", "65H", "68H", "69H", "73H", "76H", "78H", "78H", "78H", "78H", "78H"],
                1: ["1", "44", "310", "11H", "11H", "12H", "13H", "13H", "14H", "15H", "15H", "16H", "17H", "18H", "19H", "20H", "20H", "21H", "22H", "22H", "22H", "22H"]
            }
        },
        3: {
            "epen": [
                0.1, 0.2, 0.3, 0.6, 0.7, 0.8, 0.9, 1.0, 1.1, 1.2,
                1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.4
            ],
            "shock": {
                0.1: "10",
                0.2: "40",
                0.3: "50",
                0.6: "80",
                2.4: "100"
            },
            "organs": [
                (0.1, 0.2, "Eye", False),
                (0.2, 0.6, "Skull", False),
                (0.6, 1.8, "Brain", False),
                (1.9, 2.4, "Skull", False)
            ],
            "dc": {
                10: ["578", "17H", "24H", "79T", "84T", "88T", "92T", "99T", "10X", "11X", "11X", "12X", "14X", "16X", "18X", "21X", "23X", "24X", "24X"],
                9: ["339", "977", "14H", "46T", "49T", "52T", "54T", "58T", "61T", "63T", "67T", "70T", "80T", "91T", "10X", "12X", "13X", "14X", "14X"],
                8: ["185", "533", "765", "25T", "27T", "28T", "29T", "32T", "33T", "35T", "36T", "38T", "43T", "50T", "57T", "66T", "73T", "77T", "77T"],
                7: ["106", "306", "439", "14T", "15T", "16T", "17T", "18T", "19T", "20T", "21T", "22T", "25T", "29T", "33T", "38T", "42T", "44T", "44T"],
                6: ["46", "131", "188", "62K", "66K", "70K", "72K", "78K", "82K", "85K", "89K", "94K", "11T", "12T", "14T", "16T", "18T", "19T", "19T"],
                5: ["31", "88", "126", "42K", "44K", "47K", "48K", "52K", "55K", "57K", "60K", "63K", "72K", "82K", "93K", "11T", "12T", "13T", "13T"],
                4: ["18", "52", "75", "25K", "26K", "28K", "29K", "31K", "33K", "34K", "36K", "37K", "43K", "49K", "56K", "64K", "72K", "76K", "76K"],
                3: ["9", "25", "36", "12K", "13K", "13K", "14K", "15K", "16K", "16K", "17K", "18K", "21K", "24K", "27K", "31K", "35K", "37K", "37K"],
                2: ["3", "7", "10", "34H", "36H", "38H", "40H", "43H", "45H", "47H", "49H", "52H", "59H", "68H", "77H", "89H", "10K", "11K", "11K"],
                1: ["1", "2", "3", "986", "10H", "11H", "11H", "12H", "13H", "14H", "14H", "15H", "17H", "19H", "22H", "26H", "29H", "30H", "30H"]
            }
        },
        4: {
            "epen": [
                0.1, 0.2, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4,
                0.4, 0.5, 0.6, 0.7, 0.8, 1.1, 1.9, 2.0, 2.1, 2.2,
                2.5, 3.3, 3.4, 3.5
            ],
            "shock": {
                0.1: "10",
                1.1: "55",
                1.9: "410"
            },
            "organs": [
                (0.1, 0.1, "Flesh", False),
                (0.2, 0.2, "Teeth", False),
                (0.4, 0.4, "Mouth", False),
                (0.5, 1.1, "Throat", False),
                (1.9, 3.3, "Spine", True),  # Gray zone: disables body part
                (3.4, 3.5, "Flesh", False),
            ],
            "dc": {
                10: ["13", "36", "80", "80", "80", "80", "80", "80", "80", "80", "80", "398", "917", "16H", "20H", "24H", "29H", "36K", "12T", "16T", "18T", "18T", "18T", "18T"],
                9: ["4", "21", "47", "47", "47", "47", "47", "47", "47", "47", "47", "233", "538", "950", "12H", "14H", "17H", "21K", "72K", "96K", "10T", "10T", "11T", "11T"],
                8: ["2", "11", "25", "25", "25", "25", "25", "25", "25", "25", "25", "127", "293", "518", "651", "780", "933", "11K", "39K", "52K", "56K", "57K", "58K", "58K"],
                7: ["1", "7", "15", "15", "15", "15", "15", "15", "15", "15", "15", "73", "168", "298", "374", "448", "536", "66H", "23K", "30K", "32K", "33K", "33K", "33K"],
                6: ["1", "3", "6", "6", "6", "6", "6", "6", "6", "6", "6", "31", "72", "128", "160", "192", "230", "28H", "97H", "13K", "14K", "14K", "14K", "14K"],
                5: ["-", "2", "4", "4", "4", "4", "4", "4", "4", "4", "4", "21", "48", "85", "107", "129", "154", "19H", "65H", "86H", "93H", "94H", "96H", "96H"],
                4: ["-", "1", "2", "2", "2", "2", "2", "2", "2", "2", "2", "12", "29", "51", "64", "77", "92", "11H", "39H", "51H", "55H", "56H", "57H", "57H"],
                3: ["-", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "6", "14", "25", "31", "37", "44", "543", "19H", "25H", "27H", "27H", "28H", "28H"],
                2: ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "2", "4", "7", "9", "11", "13", "156", "536", "712", "765", "778", "792", "801"],
                1: ["-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "1", "1", "2", "3", "3", "4", "45", "154", "204", "220", "223", "227", "230"]
            }
        },
        5: {
            "epen": [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9],
            "shock": {},
            "organs": [
                (0.1, 0.9, "Flesh", False),
            ],
            "dc": {
                10: ["21", "52", "96", "151", "216", "313", "401", "499", "578"],
                9: ["10", "25", "46", "73", "104", "151", "193", "241", "279"],
                8: ["5", "12", "22", "35", "50", "73", "93", "116", "132"],
                7: ["3", "7", "13", "21", "30", "43", "56", "69", "79"],
                6: ["1", "3", "6", "10", "14", "21", "27", "33", "39"],
                5: ["1", "3", "5", "7", "10", "15", "19", "24", "29"],
                4: ["1", "2", "3", "5", "7", "10", "13", "16", "19"],
                3: ["1", "1", "2", "3", "4", "6", "8", "10", "11"],
                2: ["-", "1", "1", "1", "2", "3", "4", "5", "5"],
                1: ["-", "-", "1", "1", "1", "1", "1", "1", "1"]
            }
        },
        6: {
            "epen": [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.9, 1.7, 1.8, 1.9, 2.0, 2.6, 3.1, 3.2, 3.3],
            "shock": {
                0.2: "10",
                0.3: "20",
                0.4: "30",
                0.9: "120",
                1.7: "430"
            },
            "organs": [
                (0.1, 0.1, "Flesh", False),
                (0.2, 0.5, "Throat", False),
                (0.6, 0.6, "Trachea", False),
                (0.9, 0.9, "Flesh", False),
                (1.7, 3.1, "Spine", True),  # Gray zone starts here
                (3.2, 3.3, "Flesh", False),
            ],
            "dc": {
                10: ["195", "594", "12H", "19H", "28H", "32H", "34H", "12K", "75K", "13T", "17T", "18T", "18T", "18T", "18T"],
                9: ["114", "349", "691", "11H", "17H", "19H", "20H", "71H", "44K", "78K", "10T", "10T", "10T", "11T", "11T"],
                8: ["64", "194", "384", "630", "928", "10H", "11H", "39H", "24K", "43K", "57K", "57K", "58K", "60K", "60K"],
                7: ["37", "114", "226", "370", "545", "610", "648", "23H", "14K", "25K", "33K", "34K", "34K", "35K", "35K"],
                6: ["16", "49", "97", "159", "234", "262", "278", "989", "62H", "11K", "14K", "14K", "15K", "15K", "15K"],
                5: ["11", "33", "65", "106", "156", "175", "186", "662", "41H", "73H", "96H", "97H", "98H", "10K", "10K"],
                4: ["6", "20", "39", "63", "93", "104", "111", "394", "25H", "44H", "57H", "58H", "58H", "60H", "60H"],
                3: ["3", "9", "19", "31", "45", "50", "53", "190", "12H", "21H", "27H", "28H", "28H", "29H", "29H"],
                2: ["1", "3", "5", "9", "13", "14", "15", "55", "341", "604", "789", "799", "808", "836", "844"],
                1: ["-", "1", "2", "3", "4", "4", "4", "16", "98", "173", "226", "230", "232", "240", "242"]
            },
        },
        7: {
            "epen": [0.1, 0.2, 0.3, 0.4, 0.5],
            "shock": {},
            "organs": [
                (0.1, 0.5, "Flesh", False)
            ],
            "dc": {
                10: ["4", "9", "17", "26", "32"],
                9: ["2", "6", "11", "18", "22"],
                8: ["2", "4", "8", "12", "15"],
                7: ["1", "3", "6", "9", "11"],
                6: ["1", "2", "4", "6", "7"],
                5: ["1", "2", "3", "5", "6"],
                4: ["1", "1", "2", "4", "5"],
                3: ["-", "1", "2", "3", "3"],
                2: ["-", "1", "1", "1", "2"],
                1: ["-", "-", "1", "1", "1"]
            }
        },
        8: {
            "epen": [0.1, 0.2, 0.3, 0.9, 1.5, 2.1, 2.8, 4.0, 4.6, 5.3, 5.9, 11, 12],
            "shock": {
                0.9: "5",
                1.5: "10",
                2.1: "15",
                2.8: "20",
                4.0: "30",
                4.6: "40",
                5.3: "45",
                5.9: "50",
                11.0: "100"
            },
            "organs": [
                (0.1, 0.3, "Flesh", False),
                (0.9, 11.0, "Humerus", True),
                (12.0, 12.0, "Flesh", False),
            ],
            "dc": {
                10: ["15", "39", "46", "80", "121", "170", "227", "361", "439", "522", "613", "10H", "10H"],
                9: ["9", "24", "28", "49", "74", "104", "139", "221", "268", "320", "375", "10H", "10H"],
                8: ["6", "15", "18", "31", "47", "67", "89", "141", "172", "204", "240", "918", "10H"],
                7: ["4", "11", "13", "23", "35", "49", "65", "104", "126", "151", "177", "676", "10H"],
                6: ["3", "7", "9", "15", "23", "32", "43", "68", "82", "98", "115", "441", "10H"],
                5: ["2", "6", "7", "12", "18", "25", "33", "53", "64", "77", "90", "344", "842"],
                4: ["1", "3", "4", "7", "11", "15", "21", "33", "40", "47", "55", "212", "519"],
                3: ["1", "2", "2", "3", "5", "7", "10", "16", "19", "23", "27", "102", "250"],
                2: ["-", "1", "1", "1", "2", "2", "3", "5", "5", "7", "8", "29", "72"],
                1: ["-", "-", "1", "1", "1", "1", "1", "1", "2", "2", "2", "8", "21"]
            }
        },
        9: {
            "epen": [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.2, 1.4, 1.7, 1.8, 1.9],
            "shock": {
                1.7: "5"
            },
            "organs": [
                (0.1, 0.9, "Flesh", False),
                (1.2, 1.7, "Scapula", True),
                (1.8, 1.9, "Flesh", False),
            ],
            "dc": {
                10: ["47", "98", "189", "340", "488", "659", "904", "11H", "14H", "16H", "17H", "22H", "32H", "34H"],
                9: ["25", "51", "99", "177", "254", "343", "471", "586", "746", "842", "906", "11H", "17H", "18H"],
                8: ["13", "26", "51", "92", "132", "179", "256", "305", "388", "439", "472", "584", "859", "936"],
                7: ["8", "16", "32", "57", "81", "110", "151", "188", "238", "269", "290", "359", "528", "574"],
                6: ["3", "7", "14", "25", "36", "49", "67", "84", "106", "120", "129", "160", "235", "256"],
                5: ["2", "5", "9", "17", "24", "33", "45", "56", "71", "80", "86", "107", "157", "171"],
                4: ["1", "3", "6", "10", "14", "20", "27", "33", "42", "48", "51", "64", "94", "102"],
                3: ["1", "1", "3", "5", "7", "9", "13", "16", "20", "23", "25", "31", "45", "49"],
                2: ["-", "1", "1", "1", "2", "3", "4", "5", "6", "7", "7", "9", "13", "14"],
                1: ["-", "-", "1", "1", "1", "1", "1", "1", "2", "2", "2", "3", "4", "4"]
            }
        },
        10: {
            "epen": [0.1, 0.2, 0.3, 0.4, 0.5],
            "shock": {},
            "organs": [
                (0.1, 0.5, "Flesh", False)
            ],
            "dc": {
                10: ["4", "9", "17", "26", "32"],
                9: ["2", "6", "11", "18", "22"],
                8: ["2", "4", "8", "12", "15"],
                7: ["1", "3", "6", "9", "11"],
                6: ["1", "2", "4", "6", "7"],
                5: ["1", "2", "3", "5", "6"],
                4: ["1", "1", "2", "4", "5"],
                3: ["-", "1", "2", "3", "3"],
                2: ["-", "1", "1", "1", "2"],
                1: ["-", "-", "1", "1", "1"]
            }
        },
        11: {
            "epen": [0.1, 0.2, 0.3, 0.4, 0.5, 0.6],
            "shock": {},
            "organs": [
                (0.1, 0.6, "Flesh", False)
            ],
            "dc": {
                10: ["68", "100", "100", "100", "100", "100"],
                9: ["32", "79", "100", "100", "100", "100"],
                8: ["14", "36", "66", "100", "100", "100"],
                7: ["8", "20", "37", "59", "84", "100"],
                6: ["3", "9", "16", "25", "36", "46"],
                5: ["2", "6", "11", "17", "24", "31"],
                4: ["1", "3", "6", "10", "14", "18"],
                3: ["1", "2", "3", "5", "7", "9"],
                2: ["-", "1", "1", "1", "2", "3"],
                1: ["-", "-", "1", "1", "1", "1"]
            }
        },
        12: {
            "epen": [0.1, 0.2, 0.3, 0.7, 1.0, 1.4, 1.7, 2.1, 3.8, 3.9, 4.0, 4.1, 4.2],
            "shock": {
                1.0: "5",
                1.4: "10",
                1.7: "15",
                2.1: "20",
                3.8: "30"
            },
            "organs": [
                (0.1, 0.3, "Flesh", False),
                (0.7, 3.8, "Humerus", True),
                (3.9, 4.2, "Flesh", False),
            ],
            "dc": {
                10: ["68", "120", "120", "120", "120", "120", "120", "120", "120", "120", "120", "120", "120"],
                9: ["32", "79", "120", "120", "120", "120", "120", "120", "120", "120", "120", "120", "120"],
                8: ["14", "36", "58", "81", "107", "120", "120", "120", "120", "120", "120", "120", "120"],
                7: ["8", "20", "33", "46", "60", "77", "95", "115", "120", "120", "120", "120", "120"],
                6: ["3", "9", "14", "20", "26", "33", "41", "49", "120", "120", "120", "120", "120"],
                5: ["2", "6", "9", "13", "17", "22", "27", "33", "85", "120", "120", "120", "120"],
                4: ["1", "3", "6", "8", "10", "13", "16", "20", "51", "78", "111", "120", "120"],
                3: ["1", "2", "3", "4", "5", "6", "8", "9", "24", "38", "53", "71", "81"],
                2: ["-", "1", "1", "1", "1", "2", "2", "3", "7", "11", "15", "21", "23"],
                1: ["-", "-", "1", "1", "1", "1", "1", "1", "2", "3", "4", "6", "6"]
            }
        },
        13: {
            "epen": [0.1, 0.2, 0.4, 0.5, 0.7, 0.9, 1.0, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 2.0, 2.1],
            "shock": {
                0.4: "5",
                0.5: "10",
                0.7: "15",
                0.9: "20"
            },
            "organs": [
                (0.1, 0.2, "Flesh", False),
                (0.4, 1.8, "Elbow Joint", True),
                (2.0, 2.1, "Flesh", False),
            ],
            "dc": {
                10: ["20", "43", "74", "112", "120", "120", "120", "120", "120", "120", "120", "120", "120", "120", "120", "120", "120"],
                9: ["9", "20", "34", "52", "73", "120", "120", "120", "120", "120", "120", "120", "120", "120", "120", "120", "120"],
                8: ["4", "9", "16", "24", "34", "120", "120", "120", "120", "120", "120", "120", "120", "120", "120", "120", "120"],
                7: ["2", "5", "9", "13", "19", "93", "120", "120", "120", "120", "120", "120", "120", "120", "120", "120", "120"],
                6: ["1", "2", "4", "6", "8", "40", "85", "112", "117", "120", "120", "120", "120", "120", "120", "120", "120"],
                5: ["1", "1", "3", "4", "5", "27", "57", "75", "78", "82", "85", "89", "92", "96", "100", "103", "119"],
                4: ["1", "1", "2", "2", "3", "16", "34", "45", "47", "49", "51", "53", "55", "57", "59", "62", "71"],
                3: ["1", "1", "1", "1", "2", "8", "16", "22", "23", "23", "24", "25", "26", "28", "29", "30", "34"],
                2: ["-", "1", "1", "1", "1", "2", "5", "6", "6", "7", "7", "7", "8", "8", "8", "9", "10"],
                1: ["-", "-", "1", "1", "1", "1", "1", "2", "2", "2", "2", "2", "2", "2", "2", "2", "3"]
            },
        },
        14: {
            "epen": [0.1, 0.2, 0.3, 0.4, 0.5],
            "shock": {},
            "organs": [
                (0.1, 0.5, "Flesh", False)
            ],
            "dc": {
                10: ["50", "50", "50", "50", "50"],
                9: ["32", "50", "50", "50", "50"],
                8: ["14", "36", "50", "50", "50"],
                7: ["8", "20", "34", "50", "50"],
                6: ["3", "9", "16", "25", "31"],
                5: ["2", "6", "11", "17", "20"],
                4: ["1", "3", "6", "10", "12"],
                3: ["1", "2", "3", "5", "6"],
                2: ["-", "1", "1", "1", "2"],
                1: ["-", "-", "1", "1", "1"]
            }
        },
        15: {
            "epen": [0.1, 0.2, 0.5, 0.8, 1.1, 1.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9],
            "shock": {
                0.8: "5",
                1.1: "6",
                1.3: "8",
                2.4: "10"
            },
            "organs": [
                (0.1, 0.2, "Flesh", False),
                (0.5, 2.4, "Radius", True),
                (2.5, 2.9, "Flesh", False),
            ],
            "dc": {
                10: ["60", "60", "60", "60", "60", "60", "60", "60", "60", "60", "60", "60"],
                9: ["32", "60", "60", "60", "60", "60", "60", "60", "60", "60", "60", "60"],
                8: ["14", "30", "45", "60", "60", "60", "60", "60", "60", "60", "60", "60"],
                7: ["8", "17", "25", "35", "47", "59", "60", "60", "60", "60", "60", "60"],
                6: ["3", "7", "11", "15", "20", "25", "60", "60", "60", "60", "60", "60"],
                5: ["2", "5", "7", "10", "13", "17", "43", "60", "60", "60", "60", "60"],
                4: ["1", "3", "4", "6", "8", "10", "25", "46", "60", "60", "60", "60"],
                3: ["1", "1", "2", "3", "4", "5", "12", "22", "35", "50", "60", "60"],
                2: ["-", "1", "1", "1", "1", "1", "4", "6", "10", "14", "18", "20"],
                1: ["-", "-", "1", "1", "1", "1", "1", "2", "3", "4", "5", "5"]
            }
        },
        16: {
            "epen": [0.1, 0.2, 0.3, 0.4, 0.5, 0.6],
            "shock": {0.4: "5"},
            "organs": [
                (0.1, 0.2, "Flesh", False),
                (0.3, 0.4, "Metacarpals", True),
                (0.5, 0.6, "Flesh", False),
            ],
            "dc": {
                10: ["9", "15", "15", "15", "15", "15"],
                9: ["4", "9", "15", "15", "15", "15"],
                8: ["2", "4", "7", "15", "15", "15"],
                7: ["1", "2", "4", "14", "15", "15"],
                6: ["-", "1", "2", "6", "12", "15"],
                5: ["-", "1", "1", "4", "8", "14"],
                4: ["-", "-", "1", "2", "5", "8"],
                3: ["-", "-", "-", "1", "2", "4"],
                2: ["-", "-", "-", "-", "1", "1"],
                1: ["-", "-", "-", "-", "1", "1"]
            }
        },
        17: {
            "epen": [0.1, 0.2, 0.3, 0.4, 0.5, 0.6],
            "shock": {},
            "organs": [
                (0.1, 0.6, "Flesh", False)
            ],
            "dc": {
                10: ["4", "9", "17", "26", "38", "47"],
                9: ["2", "6", "11", "18", "26", "32"],
                8: ["2", "4", "8", "12", "17", "22"],
                7: ["1", "3", "6", "9", "13", "16"],
                6: ["1", "2", "4", "6", "9", "11"],
                5: ["1", "2", "3", "5", "7", "9"],
                4: ["1", "1", "2", "4", "5", "7"],
                3: ["-", "1", "2", "3", "4", "5"],
                2: ["-", "1", "1", "1", "2", "3"],
                1: ["-", "-", "1", "1", "1", "1"]
            }
        },
        18: {
            "epen": [0.1, 0.2, 0.8, 0.9, 1.0, 1.1, 1.2, 1.8, 2.3, 2.4, 2.5, 2.6, 2.9, 3.2, 3.8, 3.9],
            "shock": {
                0.8: "10",
                1.2: "230",
                1.8: "410"
            },
            "organs": [
                (0.1, 0.2, "Flesh", False),
                (0.8, 0.8, "Sternum", False),
                (0.9, 0.9, "Flesh", False),
                (1.0, 1.2, "Windpipe", False),
                (1.8, 3.8, "Spine", True),
                (3.9, 3.9, "Flesh", False),
            ],
            "dc": {
                10: ["9", "30", "715", "27H", "44H", "61H", "71H", "78H", "23K", "13T", "24T", "29T", "29T", "29T", "30T", "31T"],
                9: ["4", "14", "333", "12H", "21H", "29H", "33H", "36H", "11K", "59K", "11T", "13T", "14T", "14T", "14T", "14T"],
                8: ["2", "6", "152", "569", "944", "13H", "15H", "17H", "48H", "27K", "51K", "61K", "62K", "62K", "64K", "66K"],
                7: ["1", "4", "86", "321", "532", "734", "846", "937", "27H", "15K", "29K", "35K", "35K", "35K", "36K", "37K"],
                6: ["1", "2", "37", "138", "228", "315", "363", "402", "12H", "66H", "12K", "15K", "15K", "15K", "16K", "16K"],
                5: ["1", "1", "25", "92", "153", "211", "243", "269", "780", "44H", "82H", "99H", "10K", "10K", "10K", "11K"],
                4: ["1", "1", "15", "55", "91", "126", "145", "160", "465", "26H", "49H", "59H", "60H", "60H", "62H", "64H"],
                3: ["1", "1", "7", "26", "44", "61", "70", "77", "224", "13H", "24H", "29H", "29H", "29H", "30H", "31H"],
                2: ["-", "1", "2", "8", "13", "17", "20", "22", "64", "362", "676", "820", "825", "831", "861", "891"],
                1: ["-", "-", "1", "2", "4", "5", "6", "6", "18", "104", "194", "235", "237", "239", "247", "255"]
            }
        },
        19: {
            "epen": [0.1, 0.2, 0.4, 1.0, 1.1, 1.1, 1.3, 2.0, 2.1],
            "shock": {
                1.0: "10",
                2.0: "20"
            },
            "organs": [
                (0.1, 0.4, "Flesh", False),
                (1.0, 1.0, "Rib", False),
                (1.1, 1.3, "Lung", False),
                (2.0, 2.0, "Rib", False),
                (2.1, 2.1, "Flesh", False),
            ],
            "dc": {
                10: ["4", "11", "16", "32", "22H", "22H", "22H", "26H", "28H"],
                9: ["2", "6", "9", "17", "12H", "12H", "12H", "14H", "15H"],
                8: ["1", "3", "5", "9", "618", "618", "632", "729", "795"],
                7: ["1", "2", "3", "6", "406", "406", "417", "481", "525"],
                6: ["1", "1", "2", "3", "237", "237", "243", "280", "305"],
                5: ["1", "1", "1", "3", "190", "190", "194", "224", "244"],
                4: ["1", "1", "1", "2", "147", "147", "150", "173", "189"],
                3: ["1", "1", "1", "2", "109", "109", "111", "129", "140"],
                2: ["-", "1", "1", "1", "76", "76", "78", "90", "98"],
                1: ["-", "-", "-", "1", "62", "62", "63", "73", "79"]
            }
        },
        20: {
            "epen": [0.1, 0.2, 0.3, 0.5, 1.2, 1.3],
            "shock": {
                1.2: "10"
            },
            "organs": [
                (0.1, 0.2, "Flesh", False),
                (0.3, 0.3, "Lung", False),
                (0.5, 0.5, "Flesh", False),
                (1.2, 1.2, "Rib", False),
                (1.3, 1.3, "Flesh", False),
            ],
            "dc": {
                10: ["4", "14", "13H", "13H", "16H", "18H"],
                9: ["2", "7", "679", "699", "844", "944"],
                8: ["1", "4", "365", "375", "453", "507"],
                7: ["1", "3", "241", "248", "299", "334"],
                6: ["1", "2", "140", "144", "174", "195"],
                5: ["1", "1", "112", "115", "139", "156"],
                4: ["1", "1", "87", "89", "108", "120"],
                3: ["1", "1", "64", "66", "80", "89"],
                2: ["-", "1", "45", "46", "56", "62"],
                1: ["-", "-", "36", "37", "45", "51"]
            }
        },
        21: {
            "epen": [0.1, 0.2, 0.8, 0.9, 1.0, 1.1, 1.2, 1.8, 2.3, 2.4, 2.5, 2.6, 2.9, 3.2, 3.8, 3.9],
            "shock": {
                0.8: "10",
                1.8: "230",
                2.3: "410"
            },
            "organs": [
                (0.1, 0.1, "Flesh", False),
                (0.2, 0.8, "Sternum", False),
                (0.9, 1.2, "Heart", False),
                (1.8, 3.8, "Spine", True),
                (3.9, 3.9, "Flesh", False),
            ],
            "dc": {
                10: ["9", "30", "11K", "17T", "30X", "33X", "35X", "35X", "36X", "43X", "48X", "49X", "50X", "50X", "50X", "50X"],
                9: ["4", "14", "52H", "80K", "14X", "15X", "16X", "16X", "17X", "20X", "22X", "23X", "23X", "23X", "23X", "23X"],
                8: ["2", "6", "24H", "37K", "64T", "70T", "74T", "74T", "78T", "91T", "10X", "11X", "11X", "11X", "11X", "11X"],
                7: ["1", "4", "13H", "21K", "36T", "40T", "41T", "42T", "44T", "52T", "57T", "59T", "59T", "59T", "60T", "60T"],
                6: ["1", "2", "575", "88H", "15T", "17T", "18T", "18T", "19T", "22T", "25T", "25T", "25T", "26T", "26T", "26T"],
                5: ["1", "1", "385", "59H", "10T", "11T", "12T", "12T", "13T", "15T", "16T", "17T", "17T", "17T", "17T", "17T"],
                4: ["1", "1", "229", "35H", "62K", "68K", "71K", "71K", "75K", "88K", "98K", "10T", "10T", "10T", "10T", "10T"],
                3: ["1", "1", "110", "17H", "30K", "33K", "34K", "34K", "36K", "42K", "47K", "49K", "49K", "49K", "49K", "50K"],
                2: ["-", "1", "32", "487", "85H", "94H", "99H", "99H", "10K", "12K", "14K", "14K", "14K", "14K", "14K", "14K"],
                1: ["-", "-", "9", "140", "25H", "27H", "28H", "28H", "30H", "35H", "39H", "40H", "40H", "40H", "41H", "41H"]
            }
        },
        22: {
            "epen": [0.1, 0.5, 0.9, 1.0, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 2.0, 2.4, 2.5],
            "shock": {
                0.9: "10",
                2.4: "20"
            },
            "organs": [
                (0.1, 0.5, "Flesh", False),
                (0.9, 0.9, "Rib", False),
                (1.0, 2.0, "Liver", False),
                (2.4, 2.4, "Rib", False),
                (2.5, 2.5, "Flesh", False),
            ],
            "dc": {
                10: ["54", "125", "12H", "60H", "10K", "15K", "21K", "27K", "32K", "39K", "39K", "40K", "43K", "48K"],
                9: ["30", "70", "695", "34H", "59H", "84H", "12K", "15K", "18K", "22K", "22K", "23K", "24K", "27K"],
                8: ["14", "34", "331", "16H", "28H", "40H", "57H", "73H", "86H", "10K", "11K", "11K", "12K", "13K"],
                7: ["8", "19", "187", "905", "16H", "22H", "32H", "41H", "48H", "59H", "60H", "61H", "65H", "73H"],
                6: ["3", "8", "80", "388", "680", "964", "14H", "18H", "21H", "25H", "26H", "26H", "28H", "31H"],
                5: ["2", "5", "54", "260", "455", "645", "923", "12H", "14H", "17H", "17H", "18H", "19H", "21H"],
                4: ["1", "3", "32", "155", "271", "384", "550", "701", "825", "10H", "10H", "10H", "11H", "12H"],
                3: ["1", "2", "15", "75", "131", "185", "265", "338", "398", "488", "491", "505", "538", "599"],
                2: ["-", "1", "4", "21", "38", "53", "76", "97", "114", "140", "141", "145", "155", "172"],
                1: ["-", "1", "1", "6", "11", "15", "22", "28", "33", "40", "41", "42", "44", "49"]
            }
        },
        23: {
            "epen": [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0, 1.4, 1.7, 1.8, 1.9],
            "shock": {
                1.7: "10"
            },
            "organs": [
                (0.1, 0.3, "Flesh", False),
                (0.4, 1.0, "Liver", False),
                (1.4, 1.7, "Rib", False),
                (1.8, 1.9, "Flesh", False),
            ],
            "dc": {
                10: ["54", "112", "916", "27H", "46H", "96H", "13K", "19K", "24K", "26K", "27K", "28K", "30K", "34K"],
                9: ["30", "63", "517", "15H", "26H", "54H", "72H", "11K", "14K", "15K", "15K", "16K", "17K", "19K"],
                8: ["14", "30", "246", "729", "12H", "26H", "34H", "50H", "65H", "71H", "73H", "75H", "81H", "90H"],
                7: ["8", "17", "139", "411", "695", "15H", "19H", "28H", "37H", "40H", "41H", "42H", "46H", "51H"],
                6: ["3", "7", "60", "176", "298", "624", "826", "12H", "16H", "17H", "18H", "19H", "20H", "22H"],
                5: ["2", "5", "40", "118", "200", "418", "553", "814", "11H", "11H", "12H", "12H", "13H", "15H"],
                4: ["1", "3", "24", "70", "119", "249", "319", "485", "629", "680", "708", "721", "783", "868"],
                3: ["1", "1", "11", "34", "57", "120", "159", "234", "303", "328", "339", "348", "377", "418"],
                2: ["-", "1", "3", "10", "16", "34", "46", "67", "87", "94", "97", "100", "108", "120"],
                1: ["-", "-", "1", "3", "5", "10", "13", "19", "25", "27", "28", "29", "31", "35"]
            }
        },
        24: {
            "epen": [0.1, 0.5, 0.9, 1.0, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 2.0, 2.4, 2.5],
            "shock": {
                0.9: "10",
                2.4: "20"
            },
            "organs": [
                (0.1, 0.1, "Flesh", False),
                (0.5, 0.9, "Rib", False),
                (1.0, 1.7, "Stomach", False),
                (2.0, 2.4, "Rib", False),
                (2.5, 2.5, "Flesh", False),
            ],
            "dc": {
                10: ["9", "21", "108", "289", "472", "647", "899", "11H", "13H", "16H", "16H", "17H", "20H", "24H"],
                9: ["5", "12", "64", "172", "281", "385", "534", "670", "780", "955", "971", "10H", "12H", "15H"],
                8: ["3", "6", "34", "90", "147", "201", "279", "350", "408", "499", "508", "538", "615", "759"],
                7: ["2", "4", "21", "56", "91", "125", "174", "218", "254", "311", "316", "335", "383", "472"],
                6: ["1", "2", "11", "29", "48", "66", "91", "114", "133", "163", "165", "175", "200", "247"],
                5: ["1", "2", "8", "22", "36", "50", "63", "86", "100", "123", "125", "133", "151", "187"],
                4: ["1", "1", "6", "16", "26", "36", "49", "62", "72", "88", "90", "95", "109", "134"],
                3: ["1", "1", "4", "11", "17", "24", "33", "41", "48", "59", "60", "63", "72", "89"],
                2: ["-", "1", "2", "6", "10", "14", "19", "24", "28", "35", "36", "37", "43", "53"],
                1: ["-", "1", "2", "4", "7", "10", "14", "17", "20", "25", "26", "27", "31", "38"]
            }
        },
        25: {
            "epen": [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0, 1.4, 1.7, 1.8, 1.9],
            "shock": {
                1.7: "10"
            },
            "organs": [
                (0.1, 0.4, "Flesh", False),
                (0.5, 1.0, "Stomach", False),
                (1.4, 1.7, "Rib", False),
                (1.8, 1.9, "Flesh", False),
            ],
            "dc": {
                10: ["9", "19", "70", "154", "236", "445", "570", "810", "10H", "11H", "12H", "13H", "15H", "18H"],
                9: ["5", "11", "41", "92", "140", "264", "339", "481", "611", "673", "723", "760", "895", "11H"],
                8: ["3", "6", "22", "48", "73", "138", "177", "252", "319", "352", "378", "397", "468", "570"],
                7: ["2", "4", "13", "30", "46", "86", "110", "157", "199", "219", "235", "247", "291", "355"],
                6: ["1", "2", "7", "16", "24", "45", "58", "82", "104", "115", "123", "129", "152", "186"],
                5: ["1", "1", "5", "12", "18", "34", "44", "62", "79", "87", "93", "98", "115", "140"],
                4: ["1", "1", "4", "8", "13", "24", "31", "44", "56", "62", "67", "70", "83", "101"],
                3: ["1", "1", "3", "6", "9", "16", "21", "30", "38", "41", "44", "47", "55", "67"],
                2: ["-", "1", "2", "3", "5", "10", "12", "17", "22", "24", "26", "28", "33", "40"],
                1: ["-", "-", "1", "2", "4", "7", "9", "13", "16", "17", "19", "20", "23", "28"]
            }
        },
        26: {
            "epen": [0.1, 0.5, 0.9, 1.0, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 2.0, 2.4, 2.5],
            "shock": {
                0.9: "10",
                2.4: "20"
            },
            "organs": [
                (0.1, 0.1, "Flesh", False),
                (0.5, 0.5, "Rib", False),
                (0.9, 1.2, "Stomach", False),
                (1.3, 1.7, "Spleen", False),
                (2.0, 2.4, "Rib", False),
                (2.5, 2.5, "Flesh", False),
            ],
            "dc": {
                10: ["50", "117", "609", "16H", "27H", "46H", "92H", "14K", "18K", "26K", "28K", "29K", "31K", "35K"],
                9: ["24", "55", "285", "762", "12H", "21H", "43H", "65H", "85H", "12K", "13K", "13K", "14K", "16K"],
                8: ["11", "25", "132", "352", "575", "991", "20H", "30H", "39H", "56H", "60H", "62H", "66H", "75H"],
                7: ["6", "14", "75", "201", "328", "565", "11H", "17H", "22H", "32H", "34H", "35H", "38H", "43H"],
                6: ["3", "6", "33", "88", "144", "249", "501", "757", "979", "14H", "15H", "15H", "17H", "19H"],
                5: ["2", "4", "22", "60", "98", "169", "341", "515", "666", "956", "10H", "11H", "11H", "13H"],
                4: ["1", "3", "14", "37", "60", "104", "209", "315", "408", "585", "624", "644", "694", "785"],
                3: ["1", "1", "7", "19", "31", "53", "106", "160", "207", "297", "317", "327", "353", "399"],
                2: ["-", "1", "2", "6", "10", "18", "35", "53", "69", "99", "106", "109", "118", "133"],
                1: ["-", "1", "1", "2", "4", "7", "13", "20", "26", "37", "40", "41", "44", "50"]
            }
        },
        27: {
            "epen": [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0, 1.4, 1.7, 1.8, 1.9],
            "shock": {
                1.7: "10"
            },
            "organs": [
                (0.1, 0.2, "Flesh", False),
                (0.3, 0.5, "Stomach", False),
                (0.6, 1.0, "Kidney", False),
                (1.4, 1.7, "Rib", False),
                (1.8, 1.9, "Flesh", False),
            ],
            "dc": {
                10: ["50", "104", "393", "868", "13H", "59H", "97H", "18K", "26K", "33K", "34K", "34K", "37K", "40K"],
                9: ["24", "49", "184", "407", "623", "28H", "45H", "84H", "12K", "15K", "16K", "16K", "17K", "19K"],
                8: ["11", "23", "85", "188", "288", "13H", "21H", "39H", "56H", "71H", "73H", "75H", "80H", "88H"],
                7: ["6", "13", "48", "107", "164", "727", "12H", "22H", "32H", "40H", "42H", "43H", "46H", "50H"],
                6: ["3", "6", "21", "47", "72", "320", "526", "968", "14H", "18H", "18H", "19H", "20H", "22H"],
                5: ["2", "4", "15", "32", "49", "217", "358", "659", "956", "12H", "12H", "13H", "14H", "15H"],
                4: ["1", "2", "9", "20", "30", "133", "219", "403", "585", "741", "763", "779", "836", "915"],
                3: ["1", "1", "5", "10", "15", "68", "111", "205", "297", "377", "388", "396", "425", "465"],
                2: ["-", "1", "2", "3", "5", "23", "37", "68", "99", "126", "129", "132", "142", "155"],
                1: ["-", "-", "1", "1", "2", "8", "14", "26", "37", "47", "49", "50", "53", "58"]
            }
        },
        28: {
            "epen": [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0, 1.4, 1.7, 1.8, 1.9],
            "shock": {
                1.7: "10"
            },
            "organs": [
                (0.1, 0.2, "Flesh", False),
                (0.3, 0.7, "Liver", False),
                (0.8, 1.0, "Kidney", False),
                (1.4, 1.7, "Rib", False),
                (1.8, 1.9, "Flesh", False),
            ],
            "dc": {
                10: ["68", "141", "12H", "34H", "58H", "13K", "19K", "32K", "44K", "54K", "55K", "56K", "60K", "65K"],
                9: ["32", "66", "539", "16H", "27H", "59H", "88H", "15K", "20K", "25K", "26K", "26K", "28K", "30K"],
                8: ["14", "30", "246", "729", "12H", "27H", "40H", "67H", "93H", "11K", "12K", "12K", "13K", "14K"],
                7: ["8", "17", "139", "411", "695", "15H", "23H", "38H", "52H", "65H", "66H", "68H", "72H", "78H"],
                6: ["3", "7", "60", "176", "298", "656", "974", "16H", "22H", "28H", "28H", "29H", "31H", "34H"],
                5: ["2", "5", "40", "118", "200", "439", "652", "11H", "15H", "19H", "19H", "19H", "21H", "22H"],
                4: ["1", "3", "24", "70", "119", "262", "388", "648", "896", "11H", "11H", "12H", "12H", "13H"],
                3: ["1", "1", "11", "34", "57", "126", "187", "312", "432", "533", "547", "557", "594", "644"],
                2: ["-", "1", "3", "10", "16", "36", "54", "90", "124", "153", "157", "160", "171", "185"],
                1: ["-", "-", "1", "3", "5", "10", "15", "26", "36", "44", "45", "46", "49", "53"]
            }
        },
        29: {
            "epen": [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 1.0, 1.2, 1.8, 1.9, 2.0, 2.1, 2.4, 3.2, 3.3],
            "shock": {
                1.0: "130",
                1.2: "180",
                1.8: "400"
            },
            "organs": [
                (0.1, 0.2, "Flesh", False),
                (0.3, 0.6, "Liver", False),
                (1.0, 3.2, "Spine", True),
                (3.3, 3.3, "Flesh", False),
            ],
            "dc": {
                10: ["68", "141", "12H", "34H", "58H", "12K", "14K", "14K", "33K", "11T", "26T", "32T", "32T", "32T", "34T"],
                9: ["32", "66", "539", "16H", "27H", "57H", "65H", "67H", "15K", "52K", "12T", "15T", "15T", "15T", "16T"],
                8: ["14", "30", "246", "729", "12H", "26H", "30H", "31H", "69H", "24K", "56K", "68K", "68K", "69K", "72K"],
                7: ["8", "17", "139", "411", "695", "15H", "17H", "17H", "39H", "13K", "32K", "38K", "38K", "39K", "41K"],
                6: ["3", "7", "60", "176", "298", "624", "714", "740", "17H", "58H", "14K", "16K", "16K", "17K", "17K"],
                5: ["2", "5", "40", "118", "200", "418", "478", "495", "11H", "39H", "91H", "11K", "11K", "11K", "12K"],
                4: ["1", "3", "24", "70", "119", "249", "285", "295", "668", "23H", "54H", "65H", "66H", "67H", "69H"],
                3: ["1", "1", "11", "34", "57", "120", "137", "142", "322", "11H", "26H", "31H", "32H", "32H", "33H"],
                2: ["-", "1", "3", "10", "16", "34", "39", "41", "92", "319", "752", "902", "907", "922", "960"],
                1: ["-", "-", "1", "3", "5", "10", "11", "12", "27", "91", "216", "259", "261", "265", "276"]
            }
        },
        30: {
            "epen": [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0, 1.1, 1.2],
            "shock": {},
            "organs": [
                (0.1, 0.2, "Flesh", False),
                (0.1, 1.0, "Intestines", False),
                (1.1, 1.2, "Flesh", False),
            ],
            "dc": {
                10: ["8", "32", "82", "173", "267", "379", "542", "690", "855", "10H", "11H", "12H"],
                9: ["5", "17", "45", "95", "146", "207", "297", "378", "468", "567", "617", "666"],
                8: ["2", "9", "23", "49", "75", "106", "152", "194", "240", "290", "316", "341"],
                7: ["1", "6", "15", "31", "47", "67", "96", "122", "152", "183", "200", "216"],
                6: ["1", "3", "8", "17", "26", "36", "52", "66", "82", "99", "108", "116"],
                5: ["1", "2", "6", "13", "20", "28", "40", "51", "63", "76", "83", "89"],
                4: ["1", "2", "4", "9", "14", "20", "29", "37", "46", "56", "61", "66"],
                3: ["1", "1", "3", "6", "10", "14", "20", "26", "32", "38", "42", "45"],
                2: ["-", "1", "2", "4", "6", "9", "13", "16", "20", "24", "26", "28"],
                1: ["-", "1", "1", "3", "5", "7", "9", "12", "15", "18", "19", "21"]
            }
        },
        31: {
            "epen": [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.9, 1.2, 1.8, 1.9, 2.0, 2.1, 2.7, 3.2, 3.3],
            "shock": {
                0.9: "90",
                1.2: "180",
                1.8: "400"
            },
            "organs": [
                (0.1, 0.2, "Flesh", False),
                (0.3, 0.6, "Intestines", False),
                (1.8, 2.7, "Spine", True),
                (3.2, 3.3, "Flesh", False),
            ],
            "dc": {
                10: ["61", "232", "602", "13H", "20H", "28H", "31H", "34H", "29K", "10T", "20T", "24T", "24T", "24T", "25T"],
                9: ["28", "108", "281", "593", "913", "13H", "15H", "16H", "14K", "47K", "91K", "11T", "11T", "11T", "12T"],
                8: ["13", "50", "129", "272", "419", "593", "665", "718", "62H", "21K", "42K", "51K", "52K", "52K", "54K"],
                7: ["7", "28", "73", "154", "237", "336", "377", "406", "35H", "12K", "24K", "29K", "29K", "30K", "31K"],
                6: ["3", "12", "32", "67", "103", "145", "163", "176", "15H", "53H", "10K", "13K", "13K", "13K", "13K"],
                5: ["2", "8", "21", "45", "69", "98", "110", "118", "10H", "35H", "69H", "84H", "85H", "86H", "89H"],
                4: ["1", "5", "13", "27", "42", "59", "66", "71", "615", "21H", "41H", "51H", "51H", "52H", "54H"],
                3: ["1", "2", "6", "13", "20", "29", "32", "35", "302", "10H", "20H", "25H", "25H", "25H", "26H"],
                2: ["-", "1", "2", "4", "6", "9", "10", "11", "92", "317", "616", "754", "765", "773", "801"],
                1: ["-", "-", "1", "1", "2", "3", "3", "3", "29", "101", "197", "240", "244", "246", "255"]
            }
        },
        32: {
            "epen": [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.1, 1.7, 1.8, 1.9, 2.0, 2.1],
            "shock": {
                1.7: "20"
            },
            "organs": [
                (0.1, 0.2, "Flesh", False),
                (0.3, 0.9, "Intestines", False),
                (1.1, 1.7, "Pelvis", False),
                (1.8, 2.1, "Flesh", False)
            ],
            "dc": {
                10: ["16", "110", "213", "449", "627", "981", "14H", "17H", "19H", "20H", "24H", "30H", "34H", "37H", "39H"],
                9: ["7", "53", "102", "216", "302", "472", "675", "812", "910", "955", "11H", "15H", "16H", "18H", "19H"],
                8: ["4", "25", "49", "104", "145", "227", "325", "391", "438", "459", "551", "705", "788", "846", "906"],
                7: ["2", "15", "29", "62", "86", "135", "193", "232", "260", "273", "328", "419", "469", "503", "538"],
                6: ["1", "7", "14", "30", "41", "65", "93", "112", "125", "131", "157", "201", "225", "242", "259"],
                5: ["1", "5", "10", "21", "30", "47", "67", "80", "90", "94", "113", "145", "162", "174", "186"],
                4: ["1", "3", "7", "14", "20", "31", "44", "53", "60", "63", "75", "96", "108", "116", "124"],
                3: ["1", "2", "4", "8", "12", "18", "26", "32", "35", "37", "45", "57", "64", "69", "73"],
                2: ["-", "1", "2", "4", "6", "9", "13", "15", "17", "18", "21", "27", "30", "33", "35"],
                1: ["-", "1", "1", "2", "3", "5", "7", "9", "10", "10", "13", "16", "18", "19", "21"]
            }
        },

        34: {
            "epen": [0.1, 0.2, 0.3, 0.4, 0.5, 0.6],
            "shock": {},
            "organs": [
                (0.1, 0.6, "Flesh", False)
            ],
            "dc": {
                10: ["4", "9", "17", "26", "38", "47"],
                9: ["2", "6", "11", "18", "26", "32"],
                8: ["2", "4", "8", "12", "17", "22"],
                7: ["1", "3", "6", "9", "13", "16"],
                6: ["1", "2", "4", "6", "9", "11"],
                5: ["1", "2", "3", "5", "7", "9"],
                4: ["1", "1", "2", "4", "5", "7"],
                3: ["-", "1", "2", "3", "4", "5"],
                2: ["-", "1", "1", "1", "2", "3"],
                1: ["-", "-", "1", "1", "1", "1"]
            }
        },

        38: {
            "epen": [0.1, 0.2, 0.3, 0.4, 0.5, 0.6],
            "shock": {},
            "organs": [
                (0.1, 0.6, "Flesh", False)
            ],
            "dc": {
                10: ["68", "100", "100", "100", "100", "100"],
                9: ["32", "79", "100", "100", "100", "100"],
                8: ["14", "36", "66", "100", "100", "100"],
                7: ["8", "20", "37", "59", "84", "100"],
                6: ["3", "9", "16", "25", "36", "46"],
                5: ["2", "6", "11", "17", "24", "31"],
                4: ["1", "3", "6", "10", "14", "18"],
                3: ["1", "2", "3", "5", "7", "9"],
                2: ["-", "1", "1", "1", "2", "3"],
                1: ["-", "-", "1", "1", "1", "1"]
            }
        },
    }

    @classmethod
    def calculate_damage(cls, location: AdvancedHitLocation, dc: int, epen: float, is_front: bool) -> DamageResult:
        """
        Calculates damage from a hit.

        Args:
            location: Hit location
            dc: Damage Class (ammunition damage class)
            epen: Effective Penetration (effective penetration value)
            is_front: True if shot from front, False if from rear

        Returns:
            DamageResult with information about damage, shock, pierced organs, etc.
        """
        table_numbers = re.findall(r'S?\d+', location.value.split('(Table')[-1] if 'Table' in location.value else '')
        final_res = DamageResult(location=location)

        for t_num_str in table_numbers:
            # Try to convert to int for numeric tables, skip if alphanumeric (S-tables not yet implemented)
            try:
                t_num = int(t_num_str)
            except ValueError:
                # Skip S-tables (S1, S24, etc.) as they are not yet in TABLES_DATA
                continue

            if t_num not in cls.TABLES_DATA:
                continue

            data = cls.TABLES_DATA[t_num]
            thresholds: list[float] = data["epen"]
            dc_values: list[str] | None = data["dc"].get(dc)

            if not dc_values:
                continue

            # Find last threshold the bullet overcame
            penetration_idx = -1
            for idx, threshold_value in enumerate(thresholds):
                if epen >= threshold_value:
                    penetration_idx = idx

            if is_front:
                cls._process_front_shot(data, thresholds, dc_values, penetration_idx, epen, final_res)
            else:
                cls._process_rear_shot(data, thresholds, dc_values, penetration_idx, epen, final_res)

        return final_res

    @classmethod
    def _process_front_shot(cls, data: dict, thresholds: list[float], dc_values: list[str],
                           penetration_idx: int, epen: float, final_res: DamageResult) -> None:
        """Process shot from front (left to right)."""
        if penetration_idx >= 0:
            final_res.damage += cls.parse_val(dc_values[penetration_idx])

        # Collect organs and shock along the path
        for threshold_idx in range(penetration_idx + 1):
            cls._collect_organs_and_shock(data, thresholds, threshold_idx, final_res, is_front=True)

        # Excess EPEN if passed through completely
        if penetration_idx == len(thresholds) - 1:
            final_res.excess_epen = max(0.0, epen - thresholds[-1])

    @classmethod
    def _process_rear_shot(cls, data: dict, thresholds: list[float], dc_values: list[str],
                          penetration_idx: int, epen: float, final_res: DamageResult) -> None:
        """Process shot from rear (right to left)."""
        max_idx = len(thresholds) - 1
        max_threshold = thresholds[max_idx]
        stop_threshold = max_threshold - epen

        # Find where bullet stops
        stop_idx = next((idx for idx in range(max_idx, -1, -1) if thresholds[idx] <= stop_threshold), -1)

        # Calculate damage
        max_val = cls.parse_val(dc_values[max_idx])
        if stop_idx >= 0:
            final_res.damage += max_val - cls.parse_val(dc_values[stop_idx])
        else:
            final_res.damage += max_val
            final_res.excess_epen = epen - max_threshold

        # Collect organs along the path
        for threshold_idx in range(max_idx, stop_idx, -1):
            cls._collect_organs_and_shock(data, thresholds, threshold_idx, final_res, is_front=False)

        # Calculate shock: max shock - max unreached shock
        cls._calculate_rear_shock(data, thresholds, stop_idx, final_res)

    @classmethod
    def _collect_organs_and_shock(cls, data: dict, thresholds: list[float], threshold_idx: int,
                                  final_res: DamageResult, is_front: bool) -> None:
        """Collect organs and shock at a threshold."""
        current_threshold = thresholds[threshold_idx]

        # Add organs when entering their boundary
        for start, end, name, is_gray in data["organs"]:
            boundary = start if is_front else end
            if current_threshold == boundary:
                final_res.pierced_organs.append(name)
                if is_gray:
                    final_res.is_disabled = True

        # Collect shock (only for front shots, rear uses different logic)
        if is_front and current_threshold in data["shock"]:
            shock_val = cls.parse_val(data["shock"][current_threshold])
            final_res.shock = max(final_res.shock, shock_val)

    @classmethod
    def _calculate_rear_shock(cls, data: dict, thresholds: list[float], stop_idx: int,
                             final_res: DamageResult) -> None:
        """Calculate shock for rear shot: max shock - max unreached shock."""
        max_shock = max((cls.parse_val(data["shock"][t]) for t in thresholds if t in data["shock"]), default=0)
        max_unreached = max((cls.parse_val(data["shock"][thresholds[i]])
                            for i in range(stop_idx + 1) if thresholds[i] in data["shock"]), default=0)
        final_res.shock = max(0, max_shock - max_unreached)

    @staticmethod
    def parse_val(val: str) -> int:
        if not val or val == '-':
            return 0
        multipliers = {'H': 100, 'K': 1000, 'T': 10000, 'X': 100000, 'M': 1000000}
        val = val.strip()
        suffix = val[-1]
        if suffix in multipliers:
            return int(float(val[:-1]) * multipliers[suffix])
        return int(val)